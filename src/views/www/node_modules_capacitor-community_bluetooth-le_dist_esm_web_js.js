"use strict";
(self["webpackChunkapp"] = self["webpackChunkapp"] || []).push([["node_modules_capacitor-community_bluetooth-le_dist_esm_web_js"],{

/***/ 27071:
/*!****************************************************************************!*\
  !*** ./node_modules/@capacitor-community/bluetooth-le/dist/esm/timeout.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "runWithTimeout": () => (/* binding */ runWithTimeout)
/* harmony export */ });
/* harmony import */ var _Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);

function runWithTimeout(_x, _x2, _x3) {
  return _runWithTimeout.apply(this, arguments);
}

function _runWithTimeout() {
  _runWithTimeout = (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (promise, time, exception) {
    let timer;
    return Promise.race([promise, new Promise((_, reject) => {
      timer = setTimeout(() => reject(exception), time);
    })]).finally(() => clearTimeout(timer));
  });
  return _runWithTimeout.apply(this, arguments);
}

/***/ }),

/***/ 22366:
/*!************************************************************************!*\
  !*** ./node_modules/@capacitor-community/bluetooth-le/dist/esm/web.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "BluetoothLeWeb": () => (/* binding */ BluetoothLeWeb)
/* harmony export */ });
/* harmony import */ var _Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @capacitor/core */ 26549);
/* harmony import */ var _conversion__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./conversion */ 1193);
/* harmony import */ var _timeout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./timeout */ 27071);




class BluetoothLeWeb extends _capacitor_core__WEBPACK_IMPORTED_MODULE_1__.WebPlugin {
  constructor() {
    super(...arguments);
    this.deviceMap = new Map();
    this.discoveredDevices = new Map();
    this.scan = null;
    this.DEFAULT_CONNECTION_TIMEOUT = 10000;
    this.onAdvertisementReceivedCallback = this.onAdvertisementReceived.bind(this);
    this.onDisconnectedCallback = this.onDisconnected.bind(this);
    this.onCharacteristicValueChangedCallback = this.onCharacteristicValueChanged.bind(this);
  }

  initialize() {
    var _this = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      if (typeof navigator === 'undefined' || !navigator.bluetooth) {
        throw _this.unavailable('Web Bluetooth API not available in this browser.');
      }

      const isAvailable = yield navigator.bluetooth.getAvailability();

      if (!isAvailable) {
        throw _this.unavailable('No Bluetooth radio available.');
      }
    })();
  }

  isEnabled() {
    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      // not available on web
      return {
        value: true
      };
    })();
  }

  enable() {
    var _this2 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this2.unavailable('enable is not available on web.');
    })();
  }

  disable() {
    var _this3 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this3.unavailable('disable is not available on web.');
    })();
  }

  startEnabledNotifications() {// not available on web

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {})();
  }

  stopEnabledNotifications() {// not available on web

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {})();
  }

  isLocationEnabled() {
    var _this4 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this4.unavailable('isLocationEnabled is not available on web.');
    })();
  }

  openLocationSettings() {
    var _this5 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this5.unavailable('openLocationSettings is not available on web.');
    })();
  }

  openBluetoothSettings() {
    var _this6 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this6.unavailable('openBluetoothSettings is not available on web.');
    })();
  }

  openAppSettings() {
    var _this7 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this7.unavailable('openAppSettings is not available on web.');
    })();
  }

  setDisplayStrings() {// not available on web

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {})();
  }

  requestDevice(options) {
    var _this8 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const filters = _this8.getFilters(options);

      const device = yield navigator.bluetooth.requestDevice({
        filters: filters.length ? filters : undefined,
        optionalServices: options === null || options === void 0 ? void 0 : options.optionalServices,
        acceptAllDevices: filters.length === 0
      });

      _this8.deviceMap.set(device.id, device);

      const bleDevice = _this8.getBleDevice(device);

      return bleDevice;
    })();
  }

  requestLEScan(options) {
    var _this9 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      _this9.requestBleDeviceOptions = options;

      const filters = _this9.getFilters(options);

      yield _this9.stopLEScan();
      _this9.discoveredDevices = new Map();
      navigator.bluetooth.removeEventListener('advertisementreceived', _this9.onAdvertisementReceivedCallback);
      navigator.bluetooth.addEventListener('advertisementreceived', _this9.onAdvertisementReceivedCallback);
      _this9.scan = yield navigator.bluetooth.requestLEScan({
        filters: filters.length ? filters : undefined,
        acceptAllAdvertisements: filters.length === 0,
        keepRepeatedDevices: options === null || options === void 0 ? void 0 : options.allowDuplicates
      });
    })();
  }

  onAdvertisementReceived(event) {
    var _a, _b;

    const deviceId = event.device.id;
    this.deviceMap.set(deviceId, event.device);
    const isNew = !this.discoveredDevices.has(deviceId);

    if (isNew || ((_a = this.requestBleDeviceOptions) === null || _a === void 0 ? void 0 : _a.allowDuplicates)) {
      this.discoveredDevices.set(deviceId, true);
      const device = this.getBleDevice(event.device);
      const result = {
        device,
        localName: device.name,
        rssi: event.rssi,
        txPower: event.txPower,
        manufacturerData: (0,_conversion__WEBPACK_IMPORTED_MODULE_2__.mapToObject)(event.manufacturerData),
        serviceData: (0,_conversion__WEBPACK_IMPORTED_MODULE_2__.mapToObject)(event.serviceData),
        uuids: (_b = event.uuids) === null || _b === void 0 ? void 0 : _b.map(_conversion__WEBPACK_IMPORTED_MODULE_2__.webUUIDToString)
      };
      this.notifyListeners('onScanResult', result);
    }
  }

  stopLEScan() {
    var _this10 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      var _a;

      if ((_a = _this10.scan) === null || _a === void 0 ? void 0 : _a.active) {
        _this10.scan.stop();
      }

      _this10.scan = null;
    })();
  }

  getDevices(_options) {
    var _this11 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const devices = yield navigator.bluetooth.getDevices();
      const bleDevices = devices.map(device => {
        _this11.deviceMap.set(device.id, device);

        const bleDevice = _this11.getBleDevice(device);

        return bleDevice;
      });
      return {
        devices: bleDevices
      };
    })();
  }

  getConnectedDevices(_options) {
    var _this12 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const devices = yield navigator.bluetooth.getDevices();
      const bleDevices = devices.filter(device => {
        var _a;

        return (_a = device.gatt) === null || _a === void 0 ? void 0 : _a.connected;
      }).map(device => {
        _this12.deviceMap.set(device.id, device);

        const bleDevice = _this12.getBleDevice(device);

        return bleDevice;
      });
      return {
        devices: bleDevices
      };
    })();
  }

  connect(options) {
    var _this13 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      var _a, _b;

      const device = _this13.getDeviceFromMap(options.deviceId);

      device.removeEventListener('gattserverdisconnected', _this13.onDisconnectedCallback);
      device.addEventListener('gattserverdisconnected', _this13.onDisconnectedCallback);
      const timeoutError = Symbol();

      if (device.gatt === undefined) {
        throw new Error('No gatt server available.');
      }

      try {
        const timeout = (_a = options.timeout) !== null && _a !== void 0 ? _a : _this13.DEFAULT_CONNECTION_TIMEOUT;
        yield (0,_timeout__WEBPACK_IMPORTED_MODULE_3__.runWithTimeout)(device.gatt.connect(), timeout, timeoutError);
      } catch (error) {
        // cancel pending connect call, does not work yet in chromium because of a bug:
        // https://bugs.chromium.org/p/chromium/issues/detail?id=684073
        yield (_b = device.gatt) === null || _b === void 0 ? void 0 : _b.disconnect();

        if (error === timeoutError) {
          throw new Error('Connection timeout');
        } else {
          throw error;
        }
      }
    })();
  }

  onDisconnected(event) {
    const deviceId = event.target.id;
    const key = `disconnected|${deviceId}`;
    this.notifyListeners(key, null);
  }

  createBond(_options) {
    var _this14 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this14.unavailable('createBond is not available on web.');
    })();
  }

  isBonded(_options) {
    var _this15 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this15.unavailable('isBonded is not available on web.');
    })();
  }

  disconnect(options) {
    var _this16 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      var _a;

      (_a = _this16.getDeviceFromMap(options.deviceId).gatt) === null || _a === void 0 ? void 0 : _a.disconnect();
    })();
  }

  getServices(options) {
    var _this17 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      var _a, _b;

      const services = (_b = yield (_a = _this17.getDeviceFromMap(options.deviceId).gatt) === null || _a === void 0 ? void 0 : _a.getPrimaryServices()) !== null && _b !== void 0 ? _b : [];
      const bleServices = [];

      for (const service of services) {
        const characteristics = yield service.getCharacteristics();
        const bleCharacteristics = [];

        for (const characteristic of characteristics) {
          bleCharacteristics.push({
            uuid: characteristic.uuid,
            properties: _this17.getProperties(characteristic),
            descriptors: yield _this17.getDescriptors(characteristic)
          });
        }

        bleServices.push({
          uuid: service.uuid,
          characteristics: bleCharacteristics
        });
      }

      return {
        services: bleServices
      };
    })();
  }

  getDescriptors(characteristic) {
    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      try {
        const descriptors = yield characteristic.getDescriptors();
        return descriptors.map(descriptor => ({
          uuid: descriptor.uuid
        }));
      } catch (_a) {
        return [];
      }
    })();
  }

  getProperties(characteristic) {
    return {
      broadcast: characteristic.properties.broadcast,
      read: characteristic.properties.read,
      writeWithoutResponse: characteristic.properties.writeWithoutResponse,
      write: characteristic.properties.write,
      notify: characteristic.properties.notify,
      indicate: characteristic.properties.indicate,
      authenticatedSignedWrites: characteristic.properties.authenticatedSignedWrites,
      reliableWrite: characteristic.properties.reliableWrite,
      writableAuxiliaries: characteristic.properties.writableAuxiliaries
    };
  }

  getCharacteristic(options) {
    var _this18 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      var _a;

      const service = yield (_a = _this18.getDeviceFromMap(options.deviceId).gatt) === null || _a === void 0 ? void 0 : _a.getPrimaryService(options === null || options === void 0 ? void 0 : options.service);
      return service === null || service === void 0 ? void 0 : service.getCharacteristic(options === null || options === void 0 ? void 0 : options.characteristic);
    })();
  }

  getDescriptor(options) {
    var _this19 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const characteristic = yield _this19.getCharacteristic(options);
      return characteristic === null || characteristic === void 0 ? void 0 : characteristic.getDescriptor(options === null || options === void 0 ? void 0 : options.descriptor);
    })();
  }

  discoverServices(_options) {
    var _this20 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this20.unavailable('discoverServices is not available on web.');
    })();
  }

  readRssi(_options) {
    var _this21 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw _this21.unavailable('readRssi is not available on web.');
    })();
  }

  read(options) {
    var _this22 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const characteristic = yield _this22.getCharacteristic(options);
      const value = yield characteristic === null || characteristic === void 0 ? void 0 : characteristic.readValue();
      return {
        value
      };
    })();
  }

  write(options) {
    var _this23 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const characteristic = yield _this23.getCharacteristic(options);
      let dataView;

      if (typeof options.value === 'string') {
        dataView = (0,_conversion__WEBPACK_IMPORTED_MODULE_2__.hexStringToDataView)(options.value);
      } else {
        dataView = options.value;
      }

      yield characteristic === null || characteristic === void 0 ? void 0 : characteristic.writeValueWithResponse(dataView);
    })();
  }

  writeWithoutResponse(options) {
    var _this24 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const characteristic = yield _this24.getCharacteristic(options);
      let dataView;

      if (typeof options.value === 'string') {
        dataView = (0,_conversion__WEBPACK_IMPORTED_MODULE_2__.hexStringToDataView)(options.value);
      } else {
        dataView = options.value;
      }

      yield characteristic === null || characteristic === void 0 ? void 0 : characteristic.writeValueWithoutResponse(dataView);
    })();
  }

  readDescriptor(options) {
    var _this25 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const descriptor = yield _this25.getDescriptor(options);
      const value = yield descriptor === null || descriptor === void 0 ? void 0 : descriptor.readValue();
      return {
        value
      };
    })();
  }

  writeDescriptor(options) {
    var _this26 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const descriptor = yield _this26.getDescriptor(options);
      let dataView;

      if (typeof options.value === 'string') {
        dataView = (0,_conversion__WEBPACK_IMPORTED_MODULE_2__.hexStringToDataView)(options.value);
      } else {
        dataView = options.value;
      }

      yield descriptor === null || descriptor === void 0 ? void 0 : descriptor.writeValue(dataView);
    })();
  }

  startNotifications(options) {
    var _this27 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const characteristic = yield _this27.getCharacteristic(options);
      characteristic === null || characteristic === void 0 ? void 0 : characteristic.removeEventListener('characteristicvaluechanged', _this27.onCharacteristicValueChangedCallback);
      characteristic === null || characteristic === void 0 ? void 0 : characteristic.addEventListener('characteristicvaluechanged', _this27.onCharacteristicValueChangedCallback);
      yield characteristic === null || characteristic === void 0 ? void 0 : characteristic.startNotifications();
    })();
  }

  onCharacteristicValueChanged(event) {
    var _a, _b;

    const characteristic = event.target;
    const key = `notification|${(_a = characteristic.service) === null || _a === void 0 ? void 0 : _a.device.id}|${(_b = characteristic.service) === null || _b === void 0 ? void 0 : _b.uuid}|${characteristic.uuid}`;
    this.notifyListeners(key, {
      value: characteristic.value
    });
  }

  stopNotifications(options) {
    var _this28 = this;

    return (0,_Users_koushik_Development_chataBook_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const characteristic = yield _this28.getCharacteristic(options);
      yield characteristic === null || characteristic === void 0 ? void 0 : characteristic.stopNotifications();
    })();
  }

  getFilters(options) {
    var _a;

    const filters = [];

    for (const service of (_a = options === null || options === void 0 ? void 0 : options.services) !== null && _a !== void 0 ? _a : []) {
      filters.push({
        services: [service],
        name: options === null || options === void 0 ? void 0 : options.name,
        namePrefix: options === null || options === void 0 ? void 0 : options.namePrefix
      });
    }

    if (((options === null || options === void 0 ? void 0 : options.name) || (options === null || options === void 0 ? void 0 : options.namePrefix)) && filters.length === 0) {
      filters.push({
        name: options.name,
        namePrefix: options.namePrefix
      });
    }

    return filters;
  }

  getDeviceFromMap(deviceId) {
    const device = this.deviceMap.get(deviceId);

    if (device === undefined) {
      throw new Error('Device not found. Call "requestDevice", "requestLEScan" or "getDevices" first.');
    }

    return device;
  }

  getBleDevice(device) {
    var _a;

    const bleDevice = {
      deviceId: device.id,
      // use undefined instead of null if name is not available
      name: (_a = device.name) !== null && _a !== void 0 ? _a : undefined
    };
    return bleDevice;
  }

}

/***/ })

}]);
//# sourceMappingURL=node_modules_capacitor-community_bluetooth-le_dist_esm_web_js.js.map