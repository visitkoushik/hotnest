{"version":3,"file":"src_app_bills_create-bill_confirmed-bill_confirmed-bill_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAyC;AACM;AACF;AAEA;AAEY;AACH;AACD;AACwB;AACe;IAe/E,wBAAwB,SAAxB,wBAAwB;CAAG;AAA3B,wBAAwB;IAZpC,uDAAQ,CAAC;QACR,OAAO,EAAE;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,sFAA+B;YAC/B,mEAAc;YACd,gEAAU;YACV,iGAAsB;SACvB;QACD,YAAY,EAAE,CAAC,8DAAiB,CAAC;KAClC,CAAC;GACW,wBAAwB,CAAG;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzBrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;IAMaY,iBAAiB,SAAjBA,iBAAiB;EAM5BC,YACUC,MADV,EAEUC,WAFV,EAGUC,WAHV,EAIUC,QAJV,EAKUC,IALV,EAMUC,KANV,EAOUC,UAPV,EAQUC,QARV,EASUC,WATV,EASkC;IAAA;;IARxB;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IAdH,2BAA8B,IAA9B;IACA,wBAA4B,IAA5B;;IA8BP,cAAS,MAAK;MACZ,KAAKF,UAAL,CAAgBG,YAAhB,CACE,KAAKF,QADP,EAEE,SAFF,EAGE,6CAHF,EAIE;QAAEG,EAAE,EAAE,KAAN;QAAaC,MAAM,EAAE;MAArB,CAJF,EAKE,MAAK;QACH;QACA,KAAKC,UAAL,GAFG,CAGH;MACD,CATH,EAUE,MAAK,CAAG,CAVV;IAYD,CAbD;;IAeA,kBAAa,MAAK;MAChB,KAAKR,IAAL,CAAUS,SAAV,GAAsB,IAAtB;MACA,MAAMC,OAAO,GAAiB,KAAKC,UAAL,EAA9B;;MACA,IAAI,KAAKC,WAAT,EAAsB;QACpB,KAAKR,WAAL,CACGS,IADH,CACQrB,gEADR,EAC8BkB,OAD9B,EAEGK,IAFH,CAESC,CAAD,IAAM;UACV,KAAKf,KAAL,CAAWgB,YAAX,CAAwB,iBAAxB;UACA,KAAKnB,WAAL,CAAiBoB,cAAjB;UACA,KAAKtB,MAAL,CAAYuB,aAAZ,CAA0B,iBAA1B;UACA,KAAKnB,IAAL,CAAUS,SAAV,GAAsB,KAAtB;QACD,CAPH,EAQGW,KARH,CAQUJ,CAAD,IAAM;UACX,KAAKf,KAAL,CAAWgB,YAAX,CAAwB,sBAAxB;UACA,KAAKjB,IAAL,CAAUS,SAAV,GAAsB,KAAtB;QACD,CAXH;MAYD,CAbD,MAaO;QACL,KAAKR,KAAL,CAAWgB,YAAX,CAAwB,yBAAxB;MACD;IACF,CAnBD;;IAqBA,kBAAa,MAAmB;MAC9B,IAAIP,OAAO,GAAiB,EAA5B;MACAA,OAAO,CAACW,QAAR,GAAmB,KAAKC,WAAL,CAAiBD,QAApC;MACAX,OAAO,CAACa,QAAR,GAAmB,KAAKC,eAAL,EAAnB;MACAd,OAAO,CAACe,IAAR,GAAe,KAAKH,WAAL,CAAiBG,IAAhC;MACAf,OAAO,CAACgB,GAAR,GAAc,KAAKJ,WAAL,CAAiBI,GAA/B;MACAhB,OAAO,CAACiB,eAAR,GAA0B,KAAKL,WAAL,CAAiBM,aAAjB,CAA+BC,GAA/B,CACvBC,IAAD,IAAqB;QACnB,MAAMC,WAAW,GAAkB,EAAnC;QACAA,WAAW,CAACC,SAAZ,GAAwBF,IAAI,CAACG,KAA7B;QACAF,WAAW,CAACG,MAAZ,GAAqBJ,IAAI,CAACK,KAAL,CAAWC,EAAhC;QACAL,WAAW,CAACM,QAAZ,GAAuBP,IAAI,CAACK,KAAL,CAAWE,QAAlC;QACAN,WAAW,CAACO,WAAZ,GAA0BR,IAAI,CAACK,KAAL,CAAWI,SAAX,CAAqBD,WAA/C;QACAP,WAAW,CAACS,aAAZ,GAA4BV,IAAI,CAACK,KAAL,CAAWI,SAAX,CAAqBC,aAAjD;QACAT,WAAW,CAACV,QAAZ,GAAuBS,IAAI,CAACK,KAAL,CAAWd,QAAlC;QACAU,WAAW,CAACU,sBAAZ,GAAqCX,IAAI,CAACK,KAAL,CAAWM,sBAAhD;QAEA,OAAOV,WAAP;MACD,CAZuB,CAA1B;MAcArB,OAAO,CAACgC,UAAR,GAAqB,KAAKpB,WAAL,CAAiBqB,UAAjB,GAA8B,EAAnD;MACA,OAAOjC,OAAP;IACD,CAtBD;;IAwBA,uBAAkB,MAAiB;MACjC,MAAMkC,YAAY,GAAe,EAAjC;MACA,MAAMC,KAAK,GAAG,KAAKvB,WAAL,CAAiBwB,YAAjB,CAA8BC,KAA9B,CAAoC,GAApC,CAAd;MACAH,YAAY,CAACI,SAAb,GAAyBH,KAAK,CAAC,CAAD,CAA9B;MACAD,YAAY,CAACK,QAAb,GAAwBJ,KAAK,CAACK,MAAN,GAAe,CAAf,GAAmBL,KAAK,CAACA,KAAK,CAACK,MAAN,GAAe,CAAhB,CAAxB,GAA6C,EAArE;MACAN,YAAY,CAACO,UAAb,GACEN,KAAK,CAACK,MAAN,GAAe,CAAf,GAAmBL,KAAK,CAACO,KAAN,CAAY,CAAZ,EAAeP,KAAK,CAACK,MAAN,GAAe,CAA9B,EAAiCG,IAAjC,CAAsC,GAAtC,CAAnB,GAAgE,EADlE;MAEAT,YAAY,CAACU,MAAb,GAAsB,KAAKhC,WAAL,CAAiBgC,MAAvC;MACAV,YAAY,CAACW,aAAb,GAA6B,KAAKjC,WAAL,CAAiBkC,eAA9C;MACA,OAAOZ,YAAP;IACD,CAVD;;IAWA,qKAAO,aAAW;MAChB,KAAI,CAAC5C,IAAL,CAAUS,SAAV,GAAsB,IAAtB;MACA,MAAMgD,QAAQ,GAAG,CAAC,GAAG,KAAI,CAAC3D,WAAL,CAAiB4D,SAArB,CAAjB;MACAD,QAAQ,CAACE,IAAT,CAAc,EACZ,GAAG,KAAI,CAAC7D,WAAL,CAAiB8D,iBAAjB,CAAmCC,YAD1B;QAEZC,MAAM,EAAE;MAFI,CAAd;MAKA,MAAMC,EAAE,GAAG,IAAIC,IAAJ,EAAX;MACA,MAAMC,GAAG,GAAG,GAAGF,EAAE,CAACG,MAAH,EAAW,IAAIH,EAAE,CAACI,QAAH,EAAa,IAAIJ,EAAE,CAACK,WAAH,EAAgB,EAA/D;MACA,MAAM,KAAI,CAACrE,QAAL,CAAcsE,UAAd,CAAyB5E,2DAAzB,EAA0C;QAC9CwE,GAD8C;QAE9CM,KAAK,EAAE,KAAI,CAACzE,WAAL,CAAiB0E;MAFsB,CAA1C,CAAN;;MAKA,KAAI,CAACzE,QAAL,CACGsE,UADH,CACc5E,0DADd,EAC8BgE,QAD9B,EAEG1C,IAFH,CAESC,CAAD,IAAM;QACV,KAAI,CAACf,KAAL,CAAWgB,YAAX,CAAwB,cAAxB;;QACA,KAAI,CAACnB,WAAL,CAAiB4D,SAAjB,CAA2BC,IAA3B,CAAgC,EAC9B,GAAG,KAAI,CAAC7D,WAAL,CAAiB8D,iBAAjB,CAAmCC,YADR;UAE9BC,MAAM,EAAE;QAFsB,CAAhC;;QAIA,KAAI,CAAChE,WAAL,CAAiB4D,SAAjB,GAA6B,CAAC,GAAGD,QAAJ,CAA7B;;QACA,KAAI,CAAC3D,WAAL,CAAiBoB,cAAjB;;QACA,KAAI,CAACtB,MAAL,CAAYuB,aAAZ,CAA0B,iBAA1B;;QACA,KAAI,CAACnB,IAAL,CAAUS,SAAV,GAAsB,KAAtB;MACD,CAZH,EAaGW,KAbH,CAaUsD,EAAD,IAAO;QACZ,KAAI,CAAC1E,IAAL,CAAUS,SAAV,GAAsB,KAAtB;MACD,CAfH;IAgBD,CA/BD;;IAiCA,oBAAe,MAAK;MAClB,KAAKX,WAAL,CAAiB8D,iBAAjB,CAAmCC,YAAnC,CAAgDpC,IAAhD,GACE,KAAKH,WAAL,CAAiBG,IADnB;MAEA,KAAK3B,WAAL,CAAiB8D,iBAAjB,CAAmCC,YAAnC,CAAgDc,GAAhD,GACE,KAAKrD,WAAL,CAAiBsD,KAAjB,GAAyB,KAAKtD,WAAL,CAAiBG,IAD5C;IAED,CALD;EAxHI;;EAEJoD,QAAQ;IACN,KAAKjE,WAAL,GACE,KAAKZ,IAAL,CAAU8E,QAAV,CAAmBC,WAAnB,CAA+BC,SAA/B,CAA0ChE,CAAD,IAAOA,CAAC,KAAK,aAAtD,IAAuE,CAAC,CAD1E;IAGA,KAAKiE,YAAL,GACE,KAAKjF,IAAL,CAAU8E,QAAV,CAAmBC,WAAnB,CAA+BC,SAA/B,CAA0ChE,CAAD,IAAOA,CAAC,KAAK,cAAtD,IACA,CAAC,CAFH;IAGA,KAAKnB,WAAL,CAAiBqF,WAAjB,CAA6BC,SAA7B,CAAwCC,CAAD,IAAM;MAC3C,KAAKC,mBAAL,GAA2BD,CAAC,CAACE,IAA7B;MACA,KAAKC,gBAAL,GAAwBC,IAAI,CAACC,KAAL,CAAWL,CAAC,CAACE,IAAb,CAAxB;MACA,KAAKhE,WAAL,GAAmB,KAAKxB,WAAL,CAAiB8D,iBAAjB,CAAmCC,YAAtD;IACD,CAJD;EAKD;;AA9B2B;;;QAlBL7E,oDAAMA;;QAAtBD,4DAAcA;;QAIdK,+EAAWA;;QAFXF,sFAAiBA;;QAKjBK,8EAAWA;;QADXD,+EAAeA;;QAHfH,yEAAYA;;QAFZF,4DAAeA;;QAIfI,uEAAWA;;;AAaPK,iBAAiB,uDAJ7BZ,yDAAS,CAAC;EACT4G,UAAAA,4DADS;;AAAA,CAAD,CAIoB,GAAjBhG,iBAAiB,CAAjB;;;;;;;;;;;;;;;;;;;;ACnB4B;AACc;AACF;AAGrD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,8DAAiB;QAC5B,IAAI,EAAE,EAAE,KAAK,EAAE,gBAAgB,EAAC,iBAAiB,EAAC,IAAI,EAAC;KACxD;CACF,CAAC;IAMW,+BAA+B,SAA/B,+BAA+B;CAAG;AAAlC,+BAA+B;IAJ3C,uDAAQ,CAAC;QACR,OAAO,EAAE,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC;QACxC,OAAO,EAAE,CAAC,yDAAY,CAAC;KACxB,CAAC;GACW,+BAA+B,CAAG;AAAH","sources":["./src/app/bills/create-bill/confirmed-bill/confirmed-bill.module.ts","./src/app/bills/create-bill/confirmed-bill/confirmed-bill.ts","./src/app/bills/create-bill/confirmed-bill/confirmed-routing.module.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { MaterialModule } from 'src/app/material.module';\nimport { PipeModule } from 'src/app/pipe/pipe.module';\nimport { ConfiremdBillPage } from './confirmed-bill';\nimport { ConfiremedbillPageRoutingModule } from './confirmed-routing.module';\nimport { BillPrintDetailsModule } from '../../bill-print-details/bill-print-details.module';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ConfiremedbillPageRoutingModule,\n    MaterialModule,\n    PipeModule,\n    BillPrintDetailsModule\n  ],\n  declarations: [ConfiremdBillPage]\n})\nexport class ConfiremedbillPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { AlertController } from '@ionic/angular';\nimport { AppStorageService } from 'src/app/app-storage/app-storage.service';\nimport { AlertService } from 'src/app/providers/alert.service';\nimport { CartService } from 'src/app/providers/cart-service.service';\nimport { HttpService } from 'src/app/providers/http.service';\nimport { SnackbarService } from 'src/app/providers/snackbar.service';\nimport { UtilService } from 'src/app/providers/utilservice.service';\nimport { I_Bill } from 'src/model/bill';\nimport { ClassBill, I_Print } from 'src/model/billClass';\nimport { I_BillingItem, I_BillingReq, I_Customer } from 'src/model/BillingReq';\nimport { I_CartItem } from 'src/model/cartItem';\nimport { ApiEndPoint, StoreName } from 'src/model/util';\n\n@Component({\n  templateUrl: './confirmed-bill.html',\n  styleUrls: ['./confiremd-bill.scss'],\n})\nexport class ConfiremdBillPage implements OnInit {\n  public currentBillPrintStr: string = null;\n  public currentBillPrint: I_Print = null;\n  public currentBill: I_Bill;\n  BILLING_ADD: boolean;\n  BILLING_READ: boolean;\n  constructor(\n    private router: Router,\n    private activeRoute: ActivatedRoute,\n    private cartService: CartService,\n    private storeage: AppStorageService,\n    private util: UtilService,\n    private snack: SnackbarService,\n    private alertServc: AlertService,\n    private altrCtrl: AlertController,\n    private httpService: HttpService\n  ) {}\n\n  ngOnInit(): void {\n    this.BILLING_ADD =\n      this.util.metaData.accessRight.findIndex((e) => e === 'BILLING_ADD') > -1;\n\n    this.BILLING_READ =\n      this.util.metaData.accessRight.findIndex((e) => e === 'BILLING_READ') >\n      -1;\n    this.activeRoute.queryParams.subscribe((p) => {\n      this.currentBillPrintStr = p.data;\n      this.currentBillPrint = JSON.parse(p.data);\n      this.currentBill = this.cartService.createBillPageRef.currentBiill;\n    });\n  }\n\n  onDone = () => {\n    this.alertServc.presentAlert(\n      this.altrCtrl,\n      'Confirm',\n      'Are you sure, you want to confirm the bill?',\n      { ok: 'Yes', cancel: 'No' },\n      () => {\n        // eslint-disable-next-line no-underscore-dangle\n        this.uploadBill();\n        // this.done();\n      },\n      () => {}\n    );\n  };\n\n  uploadBill = () => {\n    this.util.isLoading = true;\n    const billReq: I_BillingReq = this.createBill();\n    if (this.BILLING_ADD) {\n      this.httpService\n        .post(ApiEndPoint.BILL_ADD, billReq)\n        .then((e) => {\n          this.snack.openSnackBar('Bill is created');\n          this.cartService.setDefaultBill();\n          this.router.navigateByUrl('/tab/createbill');\n          this.util.isLoading = false;\n        })\n        .catch((e) => {\n          this.snack.openSnackBar('Something went wrong');\n          this.util.isLoading = false;\n        });\n    } else {\n      this.snack.openSnackBar('Operation not permitted');\n    }\n  };\n\n  createBill = (): I_BillingReq => {\n    let billReq: I_BillingReq = {} as I_BillingReq;\n    billReq.discount = this.currentBill.discount;\n    billReq.customer = this.getCustomerInfo();\n    billReq.paid = this.currentBill.paid;\n    billReq.tax = this.currentBill.tax;\n    billReq.billingItemList = this.currentBill.itemPurchased.map(\n      (cart: I_CartItem) => {\n        const billingItem: I_BillingItem = {} as I_BillingItem;\n        billingItem.itemCount = cart.count;\n        billingItem.itemID = cart.items.id;\n        billingItem.itemName = cart.items.itemName;\n        billingItem.priceAmount = cart.items.itemPrice.priceAmount;\n        billingItem.sellingAmount = cart.items.itemPrice.sellingAmount;\n        billingItem.discount = cart.items.discount;\n        billingItem.isDiscountInPercentage = cart.items.isDiscountInPercentage;\n\n        return billingItem;\n      }\n    );\n    billReq.billNumber = this.currentBill.billnumber + '';\n    return billReq;\n  };\n\n  getCustomerInfo = (): I_Customer => {\n    const castomerInfo: I_Customer = {} as I_Customer;\n    const cName = this.currentBill.customerName.split(' ');\n    castomerInfo.firstName = cName[0];\n    castomerInfo.lastName = cName.length > 1 ? cName[cName.length - 1] : '';\n    castomerInfo.middleName =\n      cName.length > 2 ? cName.slice(1, cName.length - 1).join(' ') : '';\n    castomerInfo.gender = this.currentBill.gender;\n    castomerInfo.mobileNumbers = this.currentBill.customerContact;\n    return castomerInfo;\n  };\n  done = async () => {\n    this.util.isLoading = true;\n    const allbills = [...this.cartService.allBiills];\n    allbills.push({\n      ...this.cartService.createBillPageRef.currentBiill,\n      status: true,\n    });\n\n    const dt = new Date();\n    const key = `${dt.getDay()}-${dt.getMonth()}-${dt.getFullYear()}`;\n    await this.storeage.setStorage(StoreName.ORDER, {\n      key,\n      order: this.cartService.globalOrderNumber,\n    });\n\n    this.storeage\n      .setStorage(StoreName.BILL, allbills)\n      .then((e) => {\n        this.snack.openSnackBar('Bill created');\n        this.cartService.allBiills.push({\n          ...this.cartService.createBillPageRef.currentBiill,\n          status: true,\n        });\n        this.cartService.allBiills = [...allbills];\n        this.cartService.setDefaultBill();\n        this.router.navigateByUrl('/tab/createbill');\n        this.util.isLoading = false;\n      })\n      .catch((ex) => {\n        this.util.isLoading = false;\n      });\n  };\n\n  onChangePaid = () => {\n    this.cartService.createBillPageRef.currentBiill.paid =\n      this.currentBill.paid;\n    this.cartService.createBillPageRef.currentBiill.due =\n      this.currentBill.total - this.currentBill.paid;\n  };\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { ConfiremdBillPage } from './confirmed-bill';\n\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ConfiremdBillPage,\n    data: { title: 'Generated Bill',displayBackButton:true},\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ConfiremedbillPageRoutingModule {}\n"],"names":["Component","ActivatedRoute","Router","AlertController","AppStorageService","AlertService","CartService","HttpService","SnackbarService","UtilService","ApiEndPoint","StoreName","ConfiremdBillPage","constructor","router","activeRoute","cartService","storeage","util","snack","alertServc","altrCtrl","httpService","presentAlert","ok","cancel","uploadBill","isLoading","billReq","createBill","BILLING_ADD","post","BILL_ADD","then","e","openSnackBar","setDefaultBill","navigateByUrl","catch","discount","currentBill","customer","getCustomerInfo","paid","tax","billingItemList","itemPurchased","map","cart","billingItem","itemCount","count","itemID","items","id","itemName","priceAmount","itemPrice","sellingAmount","isDiscountInPercentage","billNumber","billnumber","castomerInfo","cName","customerName","split","firstName","lastName","length","middleName","slice","join","gender","mobileNumbers","customerContact","allbills","allBiills","push","createBillPageRef","currentBiill","status","dt","Date","key","getDay","getMonth","getFullYear","setStorage","ORDER","order","globalOrderNumber","BILL","ex","due","total","ngOnInit","metaData","accessRight","findIndex","BILLING_READ","queryParams","subscribe","p","currentBillPrintStr","data","currentBillPrint","JSON","parse","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}